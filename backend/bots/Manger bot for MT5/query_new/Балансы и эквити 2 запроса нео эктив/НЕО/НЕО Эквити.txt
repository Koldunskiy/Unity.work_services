Select 
CURRENT_DATE() as `Date`,
0 as `Start`,
SUM(case 
	when real_loginy.`Group` LIKE 'real\\\\cent\\\\bbook%' then (IFNULL(position_online.Profit, 0) + IFNULL(position_online.Storage, 0) + real_loginy.Balance) * 0.01
	when real_loginy.`Group` not LIKE 'real\\\\cent\\\\bbook%' then (IFNULL(position_online.Profit, 0) + IFNULL(position_online.Storage, 0) + real_loginy.Balance)
	else 0
end) as Equity, 
SUM(case 
		when `Group` LIKE 'real\\\\neobit\\\\bbook%' then (IFNULL(position_online.Profit, 0) + IFNULL(position_online.Storage, 0) + real_loginy.Balance) -- Группа Ббук 100% в калькуляцию
		when `Group` LIKE 'real\\\\abook\\\\abook%' and `Group` like '%10_percent' then (IFNULL(position_online.Profit, 0) + IFNULL(position_online.Storage, 0) + real_loginy.Balance) * 0.9 -- Группа абук 10 - 90% в калькуляцию
		when `Group` LIKE 'real\\\\abook\\\\abook%' and `Group` like '%20_percent' then (IFNULL(position_online.Profit, 0) + IFNULL(position_online.Storage, 0) + real_loginy.Balance) * 0.8 -- Группа абук 20 - 80% в калькуляцию
		when `Group` LIKE 'real\\\\abook\\\\abook%' and `Group` like '%30_percent' then (IFNULL(position_online.Profit, 0) + IFNULL(position_online.Storage, 0) + real_loginy.Balance) * 0.7 -- Группа абук 30 - 70% в калькуляцию
		when `Group` LIKE 'real\\\\abook\\\\abook%' and `Group` like '%40_percent' then (IFNULL(position_online.Profit, 0) + IFNULL(position_online.Storage, 0) + real_loginy.Balance) * 0.6 -- Группа абук 40 - 60% в калькуляцию
		when `Group` LIKE 'real\\\\abook\\\\abook%' and `Group` like '%50_percent' then (IFNULL(position_online.Profit, 0) + IFNULL(position_online.Storage, 0) + real_loginy.Balance) * 0.5 -- Группа абук 50 - 50% в калькуляцию
		when `Group` LIKE 'real\\\\abook\\\\abook%' and `Group` like '%60_percent' then (IFNULL(position_online.Profit, 0) + IFNULL(position_online.Storage, 0) + real_loginy.Balance) * 0.4 -- Группа абук 60 - 40% в калькуляцию
		when `Group` LIKE 'real\\\\abook\\\\abook%' and `Group` like '%70_percent' then (IFNULL(position_online.Profit, 0) + IFNULL(position_online.Storage, 0) + real_loginy.Balance) * 0.3 -- Группа абук 70 - 30% в калькуляцию
		when `Group` LIKE 'real\\\\abook\\\\abook%' and `Group` like '%80_percent' then (IFNULL(position_online.Profit, 0) + IFNULL(position_online.Storage, 0) + real_loginy.Balance) * 0.2 -- Группа абук 80 - 20% в калькуляцию
		when `Group` LIKE 'real\\\\abook\\\\abook%' and `Group` like '%90_percent' then (IFNULL(position_online.Profit, 0) + IFNULL(position_online.Storage, 0) + real_loginy.Balance) * 0.1 -- Группа абук 90 - 10% в калькуляцию
		when `Group` LIKE 'real\\\\neobit\\\\purse%' then (IFNULL(position_online.Profit, 0) + IFNULL(position_online.Storage, 0) + real_loginy.Balance)
		when `Group` LIKE 'real\\\\cent\\\\bbook%' then (IFNULL(position_online.Profit, 0) + IFNULL(position_online.Storage, 0) + real_loginy.Balance) * 0.01
		else 0
end) as BBOOK, 
SUM(case 
		when `Group` LIKE 'real\\\\abook\\\\abook%' and `Group` not like '%_percent' then (IFNULL(position_online.Profit, 0) + IFNULL(position_online.Storage, 0) + real_loginy.Balance)
		when `Group` LIKE 'real\\\\abook\\\\abook%' and `Group` like '%10_percent' then (IFNULL(position_online.Profit, 0) + IFNULL(position_online.Storage, 0) + real_loginy.Balance) * 0.1
		when `Group` LIKE 'real\\\\abook\\\\abook%' and `Group` like '%20_percent' then (IFNULL(position_online.Profit, 0) + IFNULL(position_online.Storage, 0) + real_loginy.Balance) * 0.2
		when `Group` LIKE 'real\\\\abook\\\\abook%' and `Group` like '%30_percent' then (IFNULL(position_online.Profit, 0) + IFNULL(position_online.Storage, 0) + real_loginy.Balance) * 0.3
		when `Group` LIKE 'real\\\\abook\\\\abook%' and `Group` like '%40_percent' then (IFNULL(position_online.Profit, 0) + IFNULL(position_online.Storage, 0) + real_loginy.Balance) * 0.4
		when `Group` LIKE 'real\\\\abook\\\\abook%' and `Group` like '%50_percent' then (IFNULL(position_online.Profit, 0) + IFNULL(position_online.Storage, 0) + real_loginy.Balance) * 0.5
		when `Group` LIKE 'real\\\\abook\\\\abook%' and `Group` like '%60_percent' then (IFNULL(position_online.Profit, 0) + IFNULL(position_online.Storage, 0) + real_loginy.Balance) * 0.6
		when `Group` LIKE 'real\\\\abook\\\\abook%' and `Group` like '%70_percent' then (IFNULL(position_online.Profit, 0) + IFNULL(position_online.Storage, 0) + real_loginy.Balance) * 0.7
		when `Group` LIKE 'real\\\\abook\\\\abook%' and `Group` like '%80_percent' then (IFNULL(position_online.Profit, 0) + IFNULL(position_online.Storage, 0) + real_loginy.Balance) * 0.8
		when `Group` LIKE 'real\\\\abook\\\\abook%' and `Group` like '%90_percent' then (IFNULL(position_online.Profit, 0) + IFNULL(position_online.Storage, 0) + real_loginy.Balance) * 0.9
		when `Group` LIKE 'real\\\\neobit\\\\abook%' then (IFNULL(position_online.Profit, 0) + IFNULL(position_online.Storage, 0) + real_loginy.Balance)
		when `Group` LIKE 'real\\\\abook\\\\300023_netting_USD' then (IFNULL(position_online.Profit, 0) + IFNULL(position_online.Storage, 0) + real_loginy.Balance)
		else 0
end) as ABOOK
from (
    /*начало все реальные логины*/
    select vse_aki.*
    from (
        /*конец Блок ббук группы автоматика опеределения*/
        SELECT `Group` 
        FROM mt5r1.mt5_groups
        WHERE `group` LIKE 'real\\\\neobit\\\\bbook%' and Currency ='USD' 
            or (`group` LIKE 'real\\\\abook\\\\abook%' and Currency ='USD') 
            or (`group` like 'real\\\\abook\\\\300023_netting_USD' and Currency ='USD')
            or (`group` LIKE 'real\\\\cent\\\\bbook%' and Currency ='USC')
        /*конец Блок ббук группы автоматика опеределения*/
    ) as bbook_ak 
    inner join (
        /*начало Блок все логины с исключениями*/
        select Login, `Group`, Balance, EquityPrevDay, EquityPrevMonth, Credit   
        from mt5r1.mt5_users
        where Login not in (
            /*начало Блок исключений из статистики*/
            select Login
            from mt5r1.mt5_users
            where FirstName in ( 
                'First Admin', 'FastMT Admin 1', 'FastMT Admin 2', 'FastMT Admin 3', 'FastMT Admin 4', 'FastMT Admin 5', 'FastMT Admin 6', 'Neobit Admin 1', 'Neobit Admin 2', 'FastMT Monitoring',
                'FastMT Backup', 'TestVadim', 'MT5 Monitor', 'Web API Personal Area Account', 'MT5BBProGateway', 'MT5BBProFeeder', 'FX manager sub', 'FX manager din', 'FX manager nak', 'FX manager nov',
                'FX manager ova', 'FX manager shin', 'FX manager rnov', 'FX manager hov', 'Data Export Manager', 'FX manager 2112', 'FX manager 2114', 'FX manager otov 2115', 'FX manager 2116', 'FX manager sich 2117',
                'FX manager 2118 up partner', 'FX manager 2119 up2 clients', 'FX manager 2120 Atimex', 'Manager_view only', 'Manager_Kuznecov Vladimir', 'FX manager 2123', 'FX manager 2124', 'FX manager 2125', 'FX manager 2126 lcov', 'BrokerPilot',
                'FX manager 2128', 'FX manager 2129', 'FX manager 2130', 'FX manager 2131', 'FX_Manager_2132', 'fsd gsdfg gdfs', 'Test Test ', 'Sabodin Aleksandr test Sergeevich', 'TestIossub TestVadim Petrovich', 'TestLukashin Dmitry Gennadievich',
                'Testov Test ', 'Petukhov test Alexander test Alex test', 'TestSmirnov Ivan Valerevich', 'Test Aleksandr test ', 'Petukhov Alexander sdfsdfsdf', 'Test Test Follower', 'Test Oleg Master', 'TestIvan', 'A-Book Client PnL (открытие-сделка на LP, закрытие-цена клиента, наша сторона, всегда должен быть плюс)', 'A-Book Client Position',
                'B-Book Client Position', 'A-Book and B-Book Client Position', 'TestSmirnov Ivan', 'Test Andrei ', 'Test cent', 'Monitor', 'Bruver TestSergeyTest ', 'B-Book cent Client Position', 'Test Swap Free netting платно', 'Test Centroid Trading',
                'Test admin', 'Test Stopout Plugin', 'Test Stopout Plugin 2', 'Test Stopout Plugin 3', 'Abook 50 процентов 345019', 'Bbook 50 процентов 900778', 'TestBruv Serg ', 'Тест Бородина Ксения ', 'Test Svetlana Fatima ', 'Kagirova Venera Test ',
                'Te_s', 'Test', 'TestBruv TestSerg ', 'Abook 20 процентов 345019', 'Test PAMM 1', 'Test PAMM 2', 'Test PAMM 3', 'gastinets', 'gastinets+1', 'gastinets+2',
                'kdronof', 'kdronof+1', 'kdronof+2', 'testing.process', 'testing.process+1', 'testing.process+2', 'sergey', 'sergey 2', 'sergey test deposit', 'sergey deposit test 2', 'sergey test 3',
                'Test Borodina Kseniya Vadimovna', 'test1 as', 'test D', 'sergey test ', 'For site (take swaps)', 'FastMT_Test', 'Abook ретрантсляция логина 901412_901396', 'A S test test', 'Sasha P test test', 'Vladimir Test Test',
                'Serj Test Test', 'Test Gusenkov Sergey ', 'Serj', 'Alex P Test1', 'Ксю', 'Gas test', 'Gas test2', 'Gas test3', 'Serj2', 'Test Sophia',
                'Test Kagirova Venera Ramzis', 'Gas test5', 'test21212', 'test денег нет но вы держитесь', 'Test Borodina ksenia test ', 'Serj3', '123', 'Test Redko Svetlana ', 'Nik Test 1 Master', 'Nik Test 2 Follower',
                'Serj4', 'TestBruver TestSerg ', 'Serj5', 'test1', 'B2B PL скольжения в карман компании(только плюсовые)XAUUSD.vol', 'Денег нет но вы держитесь', 'Serj8', 'Serj9'
            ) 
            OR FirstName LIKE 'Bbook %' 
            OR FirstName LIKE 'Abook %' 
            OR FirstName LIKE 'test %' 
            OR FirstName LIKE '% test' 
            OR Login IN /*начало Здесь указать логины исключения*/ ('901410') /*конец Здесь указать логины исключения*/
            /*конец Блок исключений из статистики*/
        ) 
        /*конец Блок все логины с исключениями*/
    ) as vse_aki on vse_aki.`Group`=bbook_ak.`Group`
    /*Конец все реальные логины*/
) as real_loginy -- *********************************Это основа, это значит, что если не ограничивать выдачу с фильтрами Флоатинг ПЛ + Все ПЛ не должно быть ноль, то выведены будут все логины по ббук с частичными перекрытиями в том числе
left join (select Login, SUM(Profit) as Profit, SUM(Storage) as Storage from mt5r1.mt5_positions group by Login) as position_online on position_online.Login = real_loginy.Login
;